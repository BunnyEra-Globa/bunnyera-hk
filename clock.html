<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>World Clock</title>
  <style>
    :root { color-scheme: light dark; }
    body {
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
      margin: 0; padding: 24px;
      background: #0b1020; color: #e8ecff;
    }
    .wrap { max-width: 900px; margin: 0 auto; }
    h1 { margin: 0 0 16px; font-size: 20px; font-weight: 700; letter-spacing: .2px; }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 12px;
    }
    .card {
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 12px;
      padding: 14px 14px 12px;
      backdrop-filter: blur(8px);
    }
    .label { display:flex; justify-content:space-between; align-items:baseline; gap: 8px; }
    .city { font-size: 14px; font-weight: 700; }
    .tz { font-size: 12px; opacity: .8; }
    .time {
      font-variant-numeric: tabular-nums;
      font-size: 34px;
      margin-top: 6px;
      letter-spacing: .5px;
    }
    .date { margin-top: 4px; font-size: 12px; opacity: .85; }
    .note { margin-top: 14px; font-size: 12px; opacity: .8; }
    select, button, input {
      font: inherit;
    }
    .controls {
      margin: 12px 0 18px;
      display:flex; flex-wrap:wrap; gap:10px; align-items:center;
    }
    .controls select {
      background: rgba(255,255,255,.08);
      color: inherit;
      border: 1px solid rgba(255,255,255,.18);
      border-radius: 10px;
      padding: 8px 10px;
      outline: none;
    }
    .controls button{
      background: #3b82f6;
      color: white;
      border: 0;
      border-radius: 10px;
      padding: 8px 12px;
      cursor: pointer;
    }
    .controls button.secondary{
      background: rgba(255,255,255,.10);
      color: inherit;
      border: 1px solid rgba(255,255,255,.18);
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>World Clock (Multiple Time Zones)</h1>

    <div class="controls">
      <label>
        Add timezone:
        <select id="tzSelect"></select>
      </label>
      <button id="addBtn">Add</button>
      <button id="resetBtn" class="secondary">Reset</button>
    </div>

    <div id="grid" class="grid"></div>

    <div class="note">
      Uses <code>Intl.DateTimeFormat</code> (no external libraries). Time zone support depends on your browser/OS.
    </div>
  </div>

  <script>
    // A friendly default set
    const DEFAULT_ZONES = [
      { city: "Local", tz: Intl.DateTimeFormat().resolvedOptions().timeZone || "UTC" },
      { city: "New York", tz: "America/New_York" },
      { city: "London", tz: "Europe/London" },
      { city: "Hong Kong", tz: "Asia/Hong_Kong" },
      { city: "Shanghai", tz: "Asia/Shanghai" },
      { city: "Tokyo", tz: "Asia/Tokyo" },
    ];

    // A curated list for dropdown (you can expand this)
    const ZONE_CHOICES = [
      "UTC",
      "America/New_York",
      "America/Los_Angeles",
      "America/Chicago",
      "America/Toronto",
      "America/Sao_Paulo",
      "Europe/London",
      "Europe/Paris",
      "Europe/Berlin",
      "Europe/Moscow",
      "Asia/Dubai",
      "Asia/Kolkata",
      "Asia/Bangkok",
      "Asia/Singapore",
      "Asia/Hong_Kong",
      "Asia/Shanghai",
      "Asia/Tokyo",
      "Asia/Seoul",
      "Australia/Sydney",
      "Pacific/Auckland",
    ];

    const state = {
      zones: JSON.parse(localStorage.getItem("worldclock.zones") || "null") || DEFAULT_ZONES
    };

    const grid = document.getElementById("grid");
    const tzSelect = document.getElementById("tzSelect");
    const addBtn = document.getElementById("addBtn");
    const resetBtn = document.getElementById("resetBtn");

    function save() {
      localStorage.setItem("worldclock.zones", JSON.stringify(state.zones));
    }

    function formatParts(tz) {
      const now = new Date();

      const timeFmt = new Intl.DateTimeFormat(undefined, {
        timeZone: tz,
        hour: "2-digit",
        minute: "2-digit",
        second: "2-digit",
        hour12: false
      });

      const dateFmt = new Intl.DateTimeFormat(undefined, {
        timeZone: tz,
        weekday: "short",
        year: "numeric",
        month: "short",
        day: "2-digit"
      });

      return {
        time: timeFmt.format(now),
        date: dateFmt.format(now)
      };
    }

    function render() {
      grid.innerHTML = "";

      state.zones.forEach((z, idx) => {
        const card = document.createElement("div");
        card.className = "card";

        const top = document.createElement("div");
        top.className = "label";

        const city = document.createElement("div");
        city.className = "city";
        city.textContent = z.city;

        const tz = document.createElement("div");
        tz.className = "tz";
        tz.textContent = z.tz;

        top.appendChild(city);
        top.appendChild(tz);

        const time = document.createElement("div");
        time.className = "time";
        time.dataset.tz = z.tz;
        time.textContent = "--:--:--";

        const date = document.createElement("div");
        date.className = "date";
        date.dataset.tz = z.tz;
        date.textContent = "";

        const remove = document.createElement("button");
        remove.textContent = "Remove";
        remove.className = "secondary";
        remove.style.marginTop = "10px";
        remove.onclick = () => {
          state.zones.splice(idx, 1);
          save();
          render();
          tick(); // update after DOM changes
        };

        card.appendChild(top);
        card.appendChild(time);
        card.appendChild(date);
        card.appendChild(remove);

        grid.appendChild(card);
      });

      tick();
    }

    function tick() {
      const times = document.querySelectorAll(".time");
      const dates = document.querySelectorAll(".date");

      times.forEach(el => {
        const tz = el.dataset.tz;
        const { time } = formatParts(tz);
        el.textContent = time;
      });

      dates.forEach(el => {
        const tz = el.dataset.tz;
        const { date } = formatParts(tz);
        el.textContent = date;
      });
    }

    function initSelect() {
      tzSelect.innerHTML = "";
      const used = new Set(state.zones.map(z => z.tz));

      ZONE_CHOICES.forEach(tz => {
        const opt = document.createElement("option");
        opt.value = tz;
        opt.textContent = tz + (used.has(tz) ? " (added)" : "");
        opt.disabled = used.has(tz);
        tzSelect.appendChild(opt);
      });

      // Try to default to a not-yet-added zone
      const firstEnabled = Array.from(tzSelect.options).find(o => !o.disabled);
      if (firstEnabled) tzSelect.value = firstEnabled.value;
    }

    addBtn.onclick = () => {
      const tz = tzSelect.value;
      if (!tz) return;

      // create a readable city label from tz id
      const city = tz.split("/").slice(-1)[0].replaceAll("_", " ");
      state.zones.push({ city, tz });
      save();
      initSelect();
      render();
    };

    resetBtn.onclick = () => {
      state.zones = DEFAULT_ZONES.slice();
      save();
      initSelect();
      render();
    };

    // initial
    initSelect();
    render();
    setInterval(tick, 1000);
  </script>
</body>
</html>
